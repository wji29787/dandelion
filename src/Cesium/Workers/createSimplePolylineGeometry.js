define(["./when-b43ff45e","./Check-d404a0fe","./Math-336da716","./Cartesian3-2b5b9afe","./Cartesian2-577f67dc","./Transforms-18f02e2b","./RuntimeError-bf10f3d5","./WebGLConstants-56de22c0","./ComponentDatatype-8956ad9a","./GeometryAttribute-5eb995bc","./JulianDate-53cdb307","./RequestType-beb1291d","./GeometryAttributes-fbf888b4","./IndexDatatype-c5295474","./IntersectionTests-8ff35218","./Plane-5b30f0ff","./ArcType-46047bc6","./EllipsoidRhumbLine-b4761ded","./EllipsoidGeodesic-47c65dee","./PolylinePipeline-76ef9442","./Color-b5533cf2"],function(R,e,S,I,f,O,o,t,M,U,r,a,N,F,l,i,q,n,s,H,J){"use strict";function W(e,o,t,r,a,l,i){var n=H.PolylinePipeline.numberOfPoints(e,o,a),s=t.red,p=t.green,d=t.blue,f=t.alpha,y=r.red,c=r.green,u=r.blue,h=r.alpha;if(J.Color.equals(t,r)){for(v=0;v<n;v++)l[i++]=J.Color.floatToByte(s),l[i++]=J.Color.floatToByte(p),l[i++]=J.Color.floatToByte(d),l[i++]=J.Color.floatToByte(f);return i}for(var C=(y-s)/n,T=(c-p)/n,g=(u-d)/n,m=(h-f)/n,b=i,v=0;v<n;v++)l[b++]=J.Color.floatToByte(s+v*C),l[b++]=J.Color.floatToByte(p+v*T),l[b++]=J.Color.floatToByte(d+v*g),l[b++]=J.Color.floatToByte(f+v*m);return b}function y(e){var o=(e=R.defaultValue(e,R.defaultValue.EMPTY_OBJECT)).positions,t=e.colors,r=R.defaultValue(e.colorsPerVertex,!1);this._positions=o,this._colors=t,this._colorsPerVertex=r,this._arcType=R.defaultValue(e.arcType,q.ArcType.GEODESIC),this._granularity=R.defaultValue(e.granularity,S.CesiumMath.RADIANS_PER_DEGREE),this._ellipsoid=R.defaultValue(e.ellipsoid,f.Ellipsoid.WGS84),this._workerName="createSimplePolylineGeometry";var a=1+o.length*I.Cartesian3.packedLength;a+=R.defined(t)?1+t.length*J.Color.packedLength:1,this.packedLength=a+f.Ellipsoid.packedLength+3}y.pack=function(e,o,t){var r;t=R.defaultValue(t,0);var a=e._positions,l=a.length;for(o[t++]=l,r=0;r<l;++r,t+=I.Cartesian3.packedLength)I.Cartesian3.pack(a[r],o,t);var i=e._colors,l=R.defined(i)?i.length:0;for(o[t++]=l,r=0;r<l;++r,t+=J.Color.packedLength)J.Color.pack(i[r],o,t);return f.Ellipsoid.pack(e._ellipsoid,o,t),t+=f.Ellipsoid.packedLength,o[t++]=e._colorsPerVertex?1:0,o[t++]=e._arcType,o[t]=e._granularity,o},y.unpack=function(e,o,t){o=R.defaultValue(o,0);for(var r=e[o++],a=new Array(r),l=0;l<r;++l,o+=I.Cartesian3.packedLength)a[l]=I.Cartesian3.unpack(e,o);var i=0<(r=e[o++])?new Array(r):void 0;for(l=0;l<r;++l,o+=J.Color.packedLength)i[l]=J.Color.unpack(e,o);var n=f.Ellipsoid.unpack(e,o);o+=f.Ellipsoid.packedLength;var s=1===e[o++],p=e[o++],d=e[o];return R.defined(t)?(t._positions=a,t._colors=i,t._ellipsoid=n,t._colorsPerVertex=s,t._arcType=p,t._granularity=d,t):new y({positions:a,colors:i,ellipsoid:n,colorsPerVertex:s,arcType:p,granularity:d})};var Y=new Array(2),z=new Array(2),j={positions:Y,height:z,ellipsoid:void 0,minDistance:void 0,granularity:void 0};return y.createGeometry=function(e){var o,t,r,a=e._positions,l=e._colors,i=e._colorsPerVertex,n=e._arcType,s=e._granularity,p=e._ellipsoid,d=S.CesiumMath.chordLength(s,p.maximumRadius),f=R.defined(l)&&!i,y=a.length,c=0;if(n===q.ArcType.GEODESIC||n===q.ArcType.RHUMB){var u,h,C=n===q.ArcType.GEODESIC?(u=S.CesiumMath.chordLength(s,p.maximumRadius),h=H.PolylinePipeline.numberOfPoints,H.PolylinePipeline.generateArc):(u=s,h=H.PolylinePipeline.numberOfPointsRhumbLine,H.PolylinePipeline.generateRhumbArc),T=H.PolylinePipeline.extractHeights(a,p),g=j;if(n===q.ArcType.GEODESIC?g.minDistance=d:g.granularity=s,g.ellipsoid=p,f){for(var m=0,b=0;b<y-1;b++)m+=h(a[b],a[b+1],u)+1;o=new Float64Array(3*m),r=new Uint8Array(4*m),g.positions=Y,g.height=z;var v=0;for(b=0;b<y-1;++b){Y[0]=a[b],Y[1]=a[b+1],z[0]=T[b],z[1]=T[b+1];var P=C(g);if(R.defined(l))for(var _=P.length/3,B=l[b],A=0;A<_;++A)r[v++]=J.Color.floatToByte(B.red),r[v++]=J.Color.floatToByte(B.green),r[v++]=J.Color.floatToByte(B.blue),r[v++]=J.Color.floatToByte(B.alpha);o.set(P,c),c+=P.length}}else if(g.positions=a,g.height=T,o=new Float64Array(C(g)),R.defined(l)){for(r=new Uint8Array(o.length/3*4),b=0;b<y-1;++b)c=W(a[b],a[b+1],l[b],l[b+1],d,r,c);var E=l[y-1];r[c++]=J.Color.floatToByte(E.red),r[c++]=J.Color.floatToByte(E.green),r[c++]=J.Color.floatToByte(E.blue),r[c++]=J.Color.floatToByte(E.alpha)}}else{t=f?2*y-2:y,o=new Float64Array(3*t),r=R.defined(l)?new Uint8Array(4*t):void 0;var k=0,D=0;for(b=0;b<y;++b){var G=a[b];if(f&&0<b&&(I.Cartesian3.pack(G,o,k),k+=3,B=l[b-1],r[D++]=J.Color.floatToByte(B.red),r[D++]=J.Color.floatToByte(B.green),r[D++]=J.Color.floatToByte(B.blue),r[D++]=J.Color.floatToByte(B.alpha)),f&&b===y-1)break;I.Cartesian3.pack(G,o,k),k+=3,R.defined(l)&&(B=l[b],r[D++]=J.Color.floatToByte(B.red),r[D++]=J.Color.floatToByte(B.green),r[D++]=J.Color.floatToByte(B.blue),r[D++]=J.Color.floatToByte(B.alpha))}}var w=new N.GeometryAttributes;w.position=new U.GeometryAttribute({componentDatatype:M.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:o}),R.defined(l)&&(w.color=new U.GeometryAttribute({componentDatatype:M.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,values:r,normalize:!0}));var L=2*((t=o.length/3)-1),V=F.IndexDatatype.createTypedArray(t,L),x=0;for(b=0;b<t-1;++b)V[x++]=b,V[x++]=b+1;return new U.Geometry({attributes:w,indices:V,primitiveType:U.PrimitiveType.LINES,boundingSphere:O.BoundingSphere.fromPoints(a)})},function(e,o){return R.defined(o)&&(e=y.unpack(e,o)),e._ellipsoid=f.Ellipsoid.clone(e._ellipsoid),y.createGeometry(e)}});
