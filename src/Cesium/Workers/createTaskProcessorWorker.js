define(["./when-b43ff45e"],function(i){"use strict";return function(a){var s;return function(e){var r=e.data,n=[],t={id:r.id,result:void 0,error:void 0};return i.defined(e.currentTarget)&&i.defined(e.currentTarget.indexedDB)&&i.defined(r.parameters)&&(r.parameters.indexedDB=e.currentTarget.indexedDB,r.parameters.workerTaskID=r.id),i.when(function(e,r,n){try{return e(r,n)}catch(e){return i.when.reject(e)}}(a,r.parameters,n)).then(function(e){t.result=e}).otherwise(function(e){e instanceof Error?t.error={name:e.name,message:e.message,stack:e.stack}:t.error=e}).always(function(){i.defined(s)||(s=i.defaultValue(self.webkitPostMessage,self.postMessage)),r.canTransferArrayBuffer||(n.length=0);try{s(t,n)}catch(e){t.result=void 0,t.error="postMessage failed with error: "+function(e){var r=e.name,n=e.message,t=i.defined(r)&&i.defined(n)?r+": "+n:e.toString(),a=e.stack;return i.defined(a)&&(t+="\n"+a),t}(e)+"\n  with responseMessage: "+JSON.stringify(t),s(t)}})}}});
