function defined(e){return null!=e}self.onmessage=function(e){var o=e.data,n=new XMLHttpRequest;if(o.withCredentials&&(n.withCredentials=!0),n.open(o.method,o.url,!0),defined(o.overrideMimeType)&&defined(n.overrideMimeType)&&n.overrideMimeType(o.overrideMimeType),defined(o.headers))for(var s in o.headers)o.headers.hasOwnProperty(s)&&n.setRequestHeader(s,o.headers[s]);defined(o.responseType)&&(n.responseType=o.responseType);var p=self.webkitPostMessage||self.postMessage;n.onload=function(){var e,r,s=n.response,t=n.responseType;if(!(n.status<200||300<=n.status)||o.localFile&&0===n.status||p({requestParam:o,status:0,xhrStatus:n.status,browserResponseType:t,xhrResponse:s,xhrResponseHeaders:n.getAllResponseHeaders()}),"HEAD"!==o.method&&"OPTIONS"!==o.method||(e=n.getAllResponseHeaders().trim().split(/[\r\n]+/),r={},e.forEach(function(e){var s=e.split(": "),t=s.shift();r[t]=s.join(": ")}),p({requestParam:o,status:0,xhrStatus:n.status,browserResponseType:t,xhrResponseHeaders:r})),204===n.status)p({requestParam:o,status:0,xhrStatus:n.status,browserResponseType:t});else if(!defined(s)||defined(o.responseType)&&t!==o.responseType)if("json"===o.responseType&&"string"==typeof s)try{var a=JSON.parse(s);p({requestParam:o,status:0,xhrStatus:n.status,jsonStatus:0,browserResponseType:t,xhrResponse:a})}catch(e){p({requestParam:o,status:0,xhrStatus:n.status,jsonStatus:1,browserResponseType:t,xhrResponse:e})}else(""===t||"document"===t)&&defined(n.responseXML)&&n.responseXML.hasChildNodes()?p({requestParam:o,status:0,xhrStatus:n.status,browserResponseType:t,responseXML:n.responseXML}):""!==t&&"text"!==t||!defined(n.responseText)?p({requestParam:o,status:0,xhrStatus:n.status,browserResponseType:t,responseTypeError:1}):p({requestParam:o,status:0,xhrStatus:n.status,browserResponseType:t,responseText:n.responseText});else p({requestParam:o,status:0,xhrStatus:n.status,browserResponseType:t,xhrResponse:s})},n.onerror=function(e){p({requestParam:o,status:1})},n.send(o.data)};