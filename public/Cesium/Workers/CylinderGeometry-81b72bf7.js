define(["exports","./when-b43ff45e","./Check-d404a0fe","./Math-336da716","./Cartesian3-2b5b9afe","./Cartesian2-577f67dc","./Transforms-18f02e2b","./ComponentDatatype-8956ad9a","./GeometryAttribute-5eb995bc","./GeometryAttributes-fbf888b4","./IndexDatatype-c5295474","./GeometryOffsetAttribute-9f7392ac","./VertexFormat-89c0971b","./CylinderGeometryLibrary-e4433c22"],function(t,U,e,Y,Z,J,W,j,q,H,K,Q,p,X){"use strict";var $=new J.Cartesian2,tt=new Z.Cartesian3,et=new Z.Cartesian3,at=new Z.Cartesian3,ot=new Z.Cartesian3;function l(t){var e=(t=U.defaultValue(t,U.defaultValue.EMPTY_OBJECT)).length,a=t.topRadius,o=t.bottomRadius,r=U.defaultValue(t.vertexFormat,p.VertexFormat.DEFAULT),n=U.defaultValue(t.slices,128),i=U.defaultValue(t.showBottom,!0),s=U.defaultValue(t.showTop,!0),m=U.defaultValue(t.changeStCoordinate,!1);this._length=e,this._topRadius=a,this._bottomRadius=o,this._vertexFormat=p.VertexFormat.clone(r),this._slices=n,this._showBottom=i,this._showTop=s,this._changeStCoordinate=m,this._offsetAttribute=t.offsetAttribute,this._workerName="createCylinderGeometry"}l.packedLength=p.VertexFormat.packedLength+8,l.pack=function(t,e,a){return a=U.defaultValue(a,0),p.VertexFormat.pack(t._vertexFormat,e,a),a+=p.VertexFormat.packedLength,e[a++]=t._length,e[a++]=t._topRadius,e[a++]=t._bottomRadius,e[a++]=t._showBottom,e[a++]=t._showTop,e[a++]=t._changeStCoordinate,e[a++]=t._slices,e[a]=U.defaultValue(t._offsetAttribute,-1),e};var a,y=new p.VertexFormat,c={vertexFormat:y,length:void 0,topRadius:void 0,bottomRadius:void 0,showBottom:void 0,showTop:void 0,changeStCoordinate:void 0,slices:void 0,offsetAttribute:void 0};l.unpack=function(t,e,a){e=U.defaultValue(e,0);var o=p.VertexFormat.unpack(t,e,y);e+=p.VertexFormat.packedLength;var r=t[e++],n=t[e++],i=t[e++],s=t[e++],m=t[e++],u=t[e++],d=t[e++],f=t[e];return U.defined(a)?(a._vertexFormat=p.VertexFormat.clone(o,a._vertexFormat),a._length=r,a._topRadius=n,a._bottomRadius=i,a._showBottom=s,a._showTop=m,a._changeStCoordinate=u,a._slices=d,a._offsetAttribute=-1===f?void 0:f,a):(c.length=r,c.topRadius=n,c.bottomRadius=i,c.showBottom=s,c.showTop=m,c.changeStCoordinate=u,c.slices=d,c.offsetAttribute=-1===f?void 0:f,new l(c))},l.createGeometry=function(t){var e=t._length,a=t._topRadius,o=t._bottomRadius,r=t._vertexFormat,n=t._slices,i=t._showBottom,s=t._showTop,m=t._changeStCoordinate;if(!(e<=0||a<0||o<0||0===a&&0===o)){var u=n+n,d=n+u,f=u+u,p=X.CylinderGeometryLibrary.computePositions(e,a,o,n,!0),l=r.st?new Float32Array(2*f):void 0,y=r.normal?new Float32Array(3*f):void 0,c=r.tangent?new Float32Array(3*f):void 0,h=r.bitangent?new Float32Array(3*f):void 0,b=r.normal||r.tangent||r.bitangent;if(b){var v=r.tangent||r.bitangent,_=0,g=0,A=0,w=Math.atan2(o-a,e),C=tt;C.z=Math.sin(w);for(var x=Math.cos(w),F=at,T=et,V=0;V<n;V++){var G=V/n*Y.CesiumMath.TWO_PI,D=x*Math.cos(G),R=x*Math.sin(G);b&&(C.x=D,C.y=R,v&&(F=Z.Cartesian3.normalize(Z.Cartesian3.cross(Z.Cartesian3.UNIT_Z,C,F),F)),r.normal&&(y[_++]=C.x,y[_++]=C.y,y[_++]=C.z,y[_++]=C.x,y[_++]=C.y,y[_++]=C.z),r.tangent&&(c[g++]=F.x,c[g++]=F.y,c[g++]=F.z,c[g++]=F.x,c[g++]=F.y,c[g++]=F.z),r.bitangent&&(T=Z.Cartesian3.normalize(Z.Cartesian3.cross(C,F,T),T),h[A++]=T.x,h[A++]=T.y,h[A++]=T.z,h[A++]=T.x,h[A++]=T.y,h[A++]=T.z))}for(V=0;V<n;V++)r.normal&&(y[_++]=0,y[_++]=0,y[_++]=-1),r.tangent&&(c[g++]=1,c[g++]=0,c[g++]=0),r.bitangent&&(h[A++]=0,h[A++]=-1,h[A++]=0);for(V=0;V<n;V++)r.normal&&(y[_++]=0,y[_++]=0,y[_++]=1),r.tangent&&(c[g++]=1,c[g++]=0,c[g++]=0),r.bitangent&&(h[A++]=0,h[A++]=1,h[A++]=0)}var O=12*n-12,L=K.IndexDatatype.createTypedArray(f,O),S=0,B=0;for(V=0;V<n-1;V++)L[S++]=B,L[S++]=B+2,L[S++]=B+3,L[S++]=B,L[S++]=B+3,L[S++]=B+1,B+=2;if(L[S++]=u-2,L[S++]=0,L[S++]=1,L[S++]=u-2,L[S++]=1,L[S++]=u-1,i)for(V=1;V<n-1;V++)L[S++]=u+V+1,L[S++]=u+V,L[S++]=u;if(1==s)for(V=1;V<n-1;V++)L[S++]=d,L[S++]=d+V,L[S++]=d+V+1;var P=0;if(r.st){var k=Math.max(a,o);for(V=0;V<f;V++){var z=Z.Cartesian3.fromArray(p,3*V,ot);m?(0==(k=V%2?a:o)?l[P++]=1:0<=z.y?l[P++]=.25*(1-z.x/k):l[P++]=.25*(3+z.x/k),l[P++]=z.z/e+.5):(l[P++]=(z.x+k)/(2*k),l[P++]=(z.y+k)/(2*k))}}var M=new H.GeometryAttributes;r.position&&(M.position=new q.GeometryAttribute({componentDatatype:j.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:p})),r.normal&&(M.normal=new q.GeometryAttribute({componentDatatype:j.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:y})),r.tangent&&(M.tangent=new q.GeometryAttribute({componentDatatype:j.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:c})),r.bitangent&&(M.bitangent=new q.GeometryAttribute({componentDatatype:j.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:h})),r.st&&(M.st=new q.GeometryAttribute({componentDatatype:j.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:l})),$.x=.5*e,$.y=Math.max(o,a);var E,N,I=new W.BoundingSphere(Z.Cartesian3.ZERO,J.Cartesian2.magnitude($));return U.defined(t._offsetAttribute)&&(e=p.length,E=new Uint8Array(e/3),N=t._offsetAttribute===Q.GeometryOffsetAttribute.NONE?0:1,Q.arrayFill(E,N),M.applyOffset=new q.GeometryAttribute({componentDatatype:j.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:E})),new q.Geometry({attributes:M,indices:L,primitiveType:q.PrimitiveType.TRIANGLES,boundingSphere:I,offsetAttribute:t._offsetAttribute})}},l.getUnitCylinder=function(){return U.defined(a)||(a=l.createGeometry(new l({topRadius:1,bottomRadius:1,length:1,vertexFormat:p.VertexFormat.POSITION_ONLY}))),a},t.CylinderGeometry=l});
