define(["./when-b43ff45e","./Check-d404a0fe","./Math-336da716","./Cartesian3-2b5b9afe","./Cartesian2-577f67dc","./Transforms-18f02e2b","./RuntimeError-bf10f3d5","./WebGLConstants-56de22c0","./ComponentDatatype-8956ad9a","./GeometryAttribute-5eb995bc","./JulianDate-53cdb307","./RequestType-beb1291d","./GeometryAttributes-fbf888b4","./IndexDatatype-c5295474","./GeometryOffsetAttribute-9f7392ac","./EllipsoidRhumbLine-b4761ded","./PolygonPipeline-6cd12a44","./RectangleGeometryLibrary-3daf6937"],function(h,e,y,t,d,b,i,a,E,A,r,n,G,R,m,o,P,w){"use strict";var _=new b.BoundingSphere,v=new b.BoundingSphere,C=new t.Cartesian3,L=new d.Rectangle;function D(e,t){var i=e._ellipsoid,a=t.height,r=t.width,n=t.northCap,o=t.southCap,l=a,u=2,s=0,d=4;n&&(--u,--l,s+=1,d-=2),o&&(--u,--l,s+=1,d-=2),s+=u*r+2*l-d;var p,c=new Float64Array(3*s),f=0,g=0,h=C;if(n)w.RectangleGeometryLibrary.computePosition(t,i,!1,g,0,h),c[f++]=h.x,c[f++]=h.y,c[f++]=h.z;else for(p=0;p<r;p++)w.RectangleGeometryLibrary.computePosition(t,i,!1,g,p,h),c[f++]=h.x,c[f++]=h.y,c[f++]=h.z;for(p=r-1,g=1;g<a;g++)w.RectangleGeometryLibrary.computePosition(t,i,!1,g,p,h),c[f++]=h.x,c[f++]=h.y,c[f++]=h.z;if(g=a-1,!o)for(p=r-2;0<=p;p--)w.RectangleGeometryLibrary.computePosition(t,i,!1,g,p,h),c[f++]=h.x,c[f++]=h.y,c[f++]=h.z;for(p=0,g=a-2;0<g;g--)w.RectangleGeometryLibrary.computePosition(t,i,!1,g,p,h),c[f++]=h.x,c[f++]=h.y,c[f++]=h.z;for(var y=c.length/3*2,b=R.IndexDatatype.createTypedArray(c.length/3,y),m=0,_=0;_<c.length/3-1;_++)b[m++]=_,b[m++]=_+1;b[m++]=c.length/3-1,b[m++]=0;var v=new A.Geometry({attributes:new G.GeometryAttributes,primitiveType:A.PrimitiveType.LINES});return v.attributes.position=new A.GeometryAttribute({componentDatatype:E.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:c}),v.indices=b,v}function p(e){var t=(e=h.defaultValue(e,h.defaultValue.EMPTY_OBJECT)).rectangle,i=h.defaultValue(e.granularity,y.CesiumMath.RADIANS_PER_DEGREE),a=h.defaultValue(e.ellipsoid,d.Ellipsoid.WGS84),r=h.defaultValue(e.rotation,0),n=h.defaultValue(e.height,0),o=h.defaultValue(e.extrudedHeight,n);this._rectangle=d.Rectangle.clone(t),this._granularity=i,this._ellipsoid=a,this._surfaceHeight=Math.max(n,o),this._rotation=r,this._extrudedHeight=Math.min(n,o),this._offsetAttribute=e.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}p.packedLength=d.Rectangle.packedLength+d.Ellipsoid.packedLength+5,p.pack=function(e,t,i){return i=h.defaultValue(i,0),d.Rectangle.pack(e._rectangle,t,i),i+=d.Rectangle.packedLength,d.Ellipsoid.pack(e._ellipsoid,t,i),i+=d.Ellipsoid.packedLength,t[i++]=e._granularity,t[i++]=e._surfaceHeight,t[i++]=e._rotation,t[i++]=e._extrudedHeight,t[i]=h.defaultValue(e._offsetAttribute,-1),t};var c=new d.Rectangle,f=d.Ellipsoid.clone(d.Ellipsoid.UNIT_SPHERE),g={rectangle:c,ellipsoid:f,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};p.unpack=function(e,t,i){t=h.defaultValue(t,0);var a=d.Rectangle.unpack(e,t,c);t+=d.Rectangle.packedLength;var r=d.Ellipsoid.unpack(e,t,f);t+=d.Ellipsoid.packedLength;var n=e[t++],o=e[t++],l=e[t++],u=e[t++],s=e[t];return h.defined(i)?(i._rectangle=d.Rectangle.clone(a,i._rectangle),i._ellipsoid=d.Ellipsoid.clone(r,i._ellipsoid),i._surfaceHeight=o,i._rotation=l,i._extrudedHeight=u,i._offsetAttribute=-1===s?void 0:s,i):(g.granularity=n,g.height=o,g.rotation=l,g.extrudedHeight=u,g.offsetAttribute=-1===s?void 0:s,new p(g))};var x=new d.Cartographic;return p.createGeometry=function(e){var t=e._rectangle,i=e._ellipsoid,a=w.RectangleGeometryLibrary.computeOptions(t,e._granularity,e._rotation,0,L,x);if(!y.CesiumMath.equalsEpsilon(t.north,t.south,y.CesiumMath.EPSILON10)&&!y.CesiumMath.equalsEpsilon(t.east,t.west,y.CesiumMath.EPSILON10)){var r,n,o,l,u,s,d,p,c,f=e._surfaceHeight,g=e._extrudedHeight;return s=!y.CesiumMath.equalsEpsilon(f,g,0,y.CesiumMath.EPSILON2)?(o=function(e,t){var i=e._surfaceHeight,a=e._extrudedHeight,r=e._ellipsoid,n=a,o=i,l=D(e,t),u=t.height,s=t.width,d=P.PolygonPipeline.scaleToGeodeticHeight(l.attributes.position.values,o,r,!1),p=d.length,c=new Float64Array(2*p);c.set(d);var f=P.PolygonPipeline.scaleToGeodeticHeight(l.attributes.position.values,n,r);c.set(f,p),l.attributes.position.values=c;var g=t.northCap,h=t.southCap,y=4;g&&--y,h&&--y;for(var b,m,_,v=2*(c.length/3+y),E=R.IndexDatatype.createTypedArray(c.length/3,v),p=c.length/6,A=0,G=0;G<p-1;G++)E[A++]=G,E[A++]=G+1,E[A++]=G+p,E[A++]=G+p+1;return E[A++]=p-1,E[A++]=0,E[A++]=p+p-1,E[A++]=p,E[A++]=0,E[A++]=p,b=g?u-1:(m=s-1,E[A++]=m,E[A++]=m+p,s+u-2),E[A++]=b,E[A++]=b+p,h||(_=s+b-1,E[A++]=_,E[A]=_+p),l.indices=E,l}(e,a),h.defined(e._offsetAttribute)&&(r=o.attributes.position.values.length/3,n=new Uint8Array(r),n=e._offsetAttribute===m.GeometryOffsetAttribute.TOP?m.arrayFill(n,1,0,r/2):(c=e._offsetAttribute===m.GeometryOffsetAttribute.NONE?0:1,m.arrayFill(n,c)),o.attributes.applyOffset=new A.GeometryAttribute({componentDatatype:E.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:n})),l=b.BoundingSphere.fromRectangle3D(t,i,f,v),u=b.BoundingSphere.fromRectangle3D(t,i,g,_),b.BoundingSphere.union(l,u)):((o=D(e,a)).attributes.position.values=P.PolygonPipeline.scaleToGeodeticHeight(o.attributes.position.values,f,i,!1),h.defined(e._offsetAttribute)&&(d=o.attributes.position.values.length,p=new Uint8Array(d/3),c=e._offsetAttribute===m.GeometryOffsetAttribute.NONE?0:1,m.arrayFill(p,c),o.attributes.applyOffset=new A.GeometryAttribute({componentDatatype:E.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:p})),b.BoundingSphere.fromRectangle3D(t,i,f)),new A.Geometry({attributes:o.attributes,indices:o.indices,primitiveType:A.PrimitiveType.LINES,boundingSphere:s,offsetAttribute:e._offsetAttribute})}},function(e,t){return h.defined(t)&&(e=p.unpack(e,t)),e._ellipsoid=d.Ellipsoid.clone(e._ellipsoid),e._rectangle=d.Rectangle.clone(e._rectangle),p.createGeometry(e)}});
